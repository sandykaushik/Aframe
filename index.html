<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Confined Space VR Training</title>

  <!-- Libraries -->
  <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/aframe-extras@6.1.1/dist/aframe-extras.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/aframe-super-hands-component@5.0.3/dist/aframe-super-hands.min.js"></script>

  <link rel="stylesheet" href="style.css" />
  <script src="js/main.js"></script>
</head>

<body>
<a-scene
  background="color: #111111"
  fog="type: exponential; density: 0.05"
  renderer="physicallyCorrectLights: true">

  <!-- Player Rig -->
  <a-entity id="rig"
    movement-controls="speed: 0.03"
    position="0 1.6 0">

    <a-camera
      wasd-controls-enabled="false"
      look-controls
      super-hands>

      <!-- Headlamp -->
      <a-entity light="
        type: spot;
        intensity: 3.0;
        angle: 45;
        distance: 10;
        castShadow: true">
      </a-entity>

    </a-camera>
  </a-entity>

  <!-- Confined Tunnel -->
  <a-cylinder
    radius="1.2"
    height="12"
    position="0 -5 0"
    rotation="90 0 0"
    material="src: assets/rust-texture.jpg; roughness: 1">
  </a-cylinder>

  <!-- Gas Meter (Task 1) -->
  <a-box id="gas-meter"
    position="-0.4 0.5 -1"
    depth="0.15" height="0.2" width="0.3"
    material="color: #333"
    grabbable
    event-set__grab="_event: grab-start; _emit: meter-grabbed">
  </a-box>

  <!-- Leaking Hose (Task 2) -->
  <a-cylinder id="hose-hazard"
    position="0 -0.5 -3"
    radius="0.05"
    height="1.2"
    material="color: #222"
    proximity-hazard>
  </a-cylinder>

  <a-sound
    id="leakSound"
    src="assets/hissing-leak-loop.mp3"
    autoplay="true"
    loop="true"
    position="0 -0.5 -3">
  </a-sound>

  <!-- Isolation Valve (Task 4) -->
  <a-torus id="isolation-valve"
    position="0.6 -0.5 -3"
    radius="0.15"
    radius-tubular="0.03"
    rotation="90 0 0"
    color="#aa0000"
    valve-logic>
  </a-torus>

  <!-- UI Feedback -->
  <a-entity id="ui-panel"
    position="0 1.8 -1"
    look-at-camera
    visible="false">
    <a-text
      id="ui-text"
      value="Hazard Isolated Successfully"
      align="center"
      color="#00ff00">
    </a-text>
  </a-entity>

  <a-entity training-manager></a-entity>

</a-scene>
</body>
</html>
